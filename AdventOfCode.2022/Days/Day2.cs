using AdventOfCode;

namespace AdventOfCode_2022.Days;

public sealed class Day2 : DayBase
{
    private enum RPS : int
    {
        Rock = 1, 
        Paper = 2, 
        Scissors = 3,
    }

    private enum Outcome : int
    {
        Win,
        Draw,
        Lose,
    }

    private const string RawInput = @"B X
C Y
A X
B X
B Y
B X
A Z
A Z
A X
C X
C X
B X
B X
C X
C Y
A Z
B Y
C Y
C X
B X
B X
C Y
A Z
A Z
C X
A Z
A Z
B X
A X
C Y
B Y
C X
B Y
B X
B X
A X
B Y
A Z
A Z
A Z
A Z
C X
B X
B Z
B X
C Y
B X
A Z
B X
A Z
A Z
A Z
C Y
C Y
C Y
A X
B X
B X
B Y
A Z
B Y
B X
B Y
A Z
C X
B X
A Z
B X
A Z
C Y
B X
C Y
A Z
C X
C Y
C X
C Y
C X
A X
A X
B Y
A X
A Y
A X
C Y
C Y
A Z
B Y
A Z
C Y
A Z
B X
A X
B X
C Y
A Y
B X
B X
C Y
A X
A X
C Y
B Y
A Z
A X
C Y
C X
A Z
B Y
B X
B Z
C X
B Y
C X
B Z
C X
A Z
C X
C Y
C Y
B Y
B Y
C Y
A X
B Y
A Z
B X
C X
C Y
B X
A X
C Z
A Z
B Y
A X
B X
A X
B X
B Y
B X
B Y
B Y
C Y
B X
B Y
B X
B X
A Z
C Y
B Y
A Z
C X
B X
B X
B Y
B X
C Y
A Z
A Z
C Y
C Y
A X
A Z
A Z
C X
A Z
B Y
A Z
A Y
B X
A Z
C Y
C Y
B X
A Z
B X
A X
A X
B Z
C Y
C Y
C Y
C X
C Y
B X
B X
B Y
A X
B X
B X
C X
A X
C Y
B X
A Z
B Y
A Z
B Y
B X
A Y
C Y
C X
B Z
C Y
B Y
B Y
B X
C Y
B X
C Y
A Z
A X
B X
A Z
C Y
C X
C Y
B Y
B Y
A Z
C Y
B X
B X
B X
A Z
C X
A Z
B X
A Z
B X
B X
B X
B Y
C X
A Z
B X
B X
C Y
A X
B Y
B X
A Z
A Z
B X
C Y
A Z
A Z
B X
B Y
B Y
B X
A Z
C X
A Z
A X
C Y
B Z
A Z
A Z
A Z
A X
C Y
B X
C Y
A Z
A Z
C Y
B X
A Z
A X
A Y
A Z
B Y
C Y
B Y
A Z
A Z
C Y
C Y
A Z
A Z
C X
A Z
A Z
C X
C Y
B X
B Y
B Y
B X
C Y
A X
C X
A X
B X
C Y
C Y
C X
B Z
A X
A Z
C Y
C Y
C Y
B X
B Y
A Z
A Z
C X
B X
A Z
C Y
B Z
B X
A X
A Z
A X
B X
B X
A Z
A Z
B Y
B Y
B Y
B X
A Z
B X
C X
B Y
B Z
A Z
C X
C Y
B Y
A X
C X
A Z
B X
A X
A Z
B X
C X
B X
A Z
B Y
B Z
A X
C Y
A Z
B Y
B Z
C X
B X
C Y
C Y
B X
A X
B X
B Y
A Z
C Y
A Z
C Y
A Z
A X
B Z
C X
C Y
B X
C X
B Z
B X
C Y
A Z
A Z
C Y
B X
A Z
C Y
A X
B Y
A Z
B X
A Z
A Z
C Y
B X
A Z
A Z
C Y
B Y
B Y
C X
C Y
B Y
C X
B Y
A Z
C Y
B Y
A Z
B X
B X
A Y
B X
B X
B Y
B Y
C X
C Y
A Z
C X
A Z
A Z
A Y
A Z
B Z
C Y
C Y
C Y
C X
C Y
C Y
B X
C Y
C X
B X
C Y
C X
C Y
A Z
C Y
B Z
C X
A Z
C Y
C X
B X
B Z
C Y
C Y
B X
B Y
A X
B Y
A Z
C Y
C X
C X
A X
B Y
A Z
B Y
C Y
B Y
B Y
A X
C X
A Z
C X
A Z
B X
A X
A Z
B X
A X
B X
C Y
B Y
B X
C X
C Z
A Z
B Y
B X
A X
B Y
C Y
C Y
A X
C X
B Z
A Z
A Z
B X
A Z
C X
B Z
B Z
C Y
C Y
B Y
C Y
A Z
C Y
B X
B X
B X
A Y
A Z
A Z
A Z
C Y
B Y
B Y
C Y
A Z
A Z
A Y
C Y
C Y
A Z
C X
B X
A Z
C Y
C Y
A X
A Z
C X
A X
B Z
B X
B X
A Z
C Y
B Y
A Z
A Z
C Y
A Z
A X
C X
A Z
B X
C X
C Y
B Z
C Z
A Z
A X
C X
B Y
C Y
A X
B Y
A Z
B X
B Y
A X
C X
A Z
A Z
B X
A X
A X
C Y
B Y
A Z
C X
A Z
B Y
A Y
C Y
B X
C X
B X
B X
A Z
B X
C X
C Y
A Z
C Y
A Z
B Z
B Z
A Z
A Z
A Z
A Z
C Y
C Y
A Z
A Z
B Y
A Z
A Z
A X
C Y
C Z
A X
C X
B X
B X
A Z
C Y
A Z
A Z
B X
A Z
C Y
B Z
A Z
A Z
A Y
C X
A Z
B Y
B Y
C X
B X
C X
A X
C Y
A X
C X
A Z
B X
B X
A Z
B X
A Z
A X
B X
A Z
B X
C Z
B X
C Z
A Z
B X
C Y
A Z
B X
B X
B Y
C Y
A Z
A Z
C X
C Y
A Z
C Y
A Y
C Y
B Y
B Y
B X
C X
A Z
C Y
A Z
C Y
C X
A Y
C Y
C X
A Z
C Y
B X
A Z
A Z
B Y
C X
A Z
A Z
B Y
C Z
A Z
B X
B X
B Y
A Y
A X
A Z
B Y
C X
C X
B Z
B Y
A Z
B Z
C Y
B X
A X
C X
A Z
A Z
B Y
B Y
B X
C Y
A X
C X
C Z
C X
B Y
B Y
A Z
B X
A Z
A Z
C Y
C Y
A X
C X
C Y
C X
A Z
B Z
B Y
C X
A Z
B X
B X
A X
A Z
B Z
B X
A Z
A Z
A Z
B X
C Y
B X
A X
A X
C Y
A Z
C Y
B X
A Z
B X
B Y
B Y
A Z
B X
B Y
C Y
B X
B Y
B Y
B Y
A Z
C Y
B X
B Y
C Y
C X
B X
C X
A Z
C Y
A Z
A Z
C Y
B Y
A Z
B Y
B Y
B Z
B X
B X
B X
A X
C Y
B X
B X
B X
B X
B X
A Z
A Z
A Z
A Z
A Z
C Y
B Y
C X
A Z
C Y
B X
C Y
C X
A Z
A Z
B X
C Y
C Y
A Z
B X
A Z
B Y
B Y
C Y
C Z
C Y
B Y
B X
C X
C Y
B X
B X
A X
C Y
A Z
B Y
A X
C Y
A Z
A Z
A X
A Z
A X
B Y
C Y
B X
C Y
A X
C X
C X
B Y
A Z
C Y
C Z
C Y
C Y
C X
C Y
A Z
A Z
B X
C X
A Y
B X
C X
C X
B Y
A Y
A Z
C X
C X
C Z
B X
A X
C Y
A Z
B X
A Z
B X
B X
C X
B X
B X
A X
B X
B X
C Y
B Y
A Y
B X
B Z
C X
A Z
C Y
A X
C Y
C Y
B X
B X
C Y
C Y
C Y
A Z
A Z
C X
C X
B X
C Y
C Y
B X
C Y
A Z
A Z
C Y
C X
A Z
A Z
B X
B Y
C X
B X
B Z
A Z
B X
B X
B X
C Y
A Y
A Z
B Z
B X
B X
B Y
A Z
B Y
B X
A X
A Z
C Y
B X
C Y
C Y
A Z
A Z
B Z
A Z
B X
C Y
B Y
B Z
B Y
A Z
C Y
C Y
B Y
C X
C Y
A Z
C X
A Z
B X
B Y
A Z
B Z
C X
C Y
B Y
C Y
B Y
A Z
C X
B X
A Z
B X
B X
B X
A X
C X
B Y
C X
A Z
C Y
B X
A Z
A Z
A X
B Y
A Z
A Z
C X
A Z
B Y
A X
B X
B Y
A Z
B Z
B X
A Z
C Y
A X
A Z
C Y
C X
C Y
C X
A Z
A Z
A Z
C Z
C X
C Y
A Z
C Y
C Y
C Z
C Y
C Y
A X
A X
A Z
B X
B Z
A Z
B X
A Z
A Z
C X
A Z
B Y
A Z
B Z
A Z
C X
A Z
B Z
A X
C Y
B Y
C Y
C X
C Y
C X
A Z
C Y
C Y
C Y
C Y
A Z
B Z
B Y
B X
B X
C Y
A Z
A Z
A X
C X
A Z
B X
A Z
B X
C Y
C X
A Z
B X
C Y
A X
B Y
C Y
C X
A X
C Y
A Z
B X
C X
A X
B Y
B Z
A Z
A Z
A X
A Z
C X
A Z
B X
B X
C Y
B X
B X
A Z
B X
A Z
B X
B Z
A Y
A X
A Z
C X
A Z
A Z
B X
B X
B Y
B Y
A X
C X
A Z
C X
A Y
A Z
C X
B Y
A Z
C Y
A Z
A Z
C Y
A Z
A Z
A Z
A Z
B X
C Y
B Y
A X
B X
A Z
B Y
B X
B Y
B Y
C Y
C X
C X
B Y
C Y
A Z
B X
C X
B Z
A Z
C X
B X
C Y
C X
A Z
C X
C Y
B X
C X
C Y
B Y
A X
A Z
C X
C X
B X
B X
B X
C Y
B X
B X
B Y
B Y
B X
C X
C Y
B X
B X
B X
A Y
B Z
C X
C Y
C Y
B X
B X
A Z
A X
C Y
B X
C X
B X
B Y
A X
C Z
C Y
A Z
B Y
B Y
A Z
C X
C X
A Z
B Y
A Z
B X
A Z
C Y
C Y
B Y
A Z
A Z
A Z
C Y
C Y
A X
C X
B Y
C Y
C Y
C X
A Z
A Z
C X
C Y
A X
B X
A X
B Y
A X
A Z
A Z
C Y
A Z
B X
C X
A Z
A Z
A Z
C Y
C X
A Z
C Y
C Y
B X
B X
C X
B X
C X
A Z
B X
B Z
B X
B X
C Y
A X
A Z
B X
A Z
C Y
A Z
C Z
A Z
C Z
C X
A Z
B Z
A Z
C Y
B X
C Y
A Y
C Y
C X
B X
B Y
C X
A Z
B Z
A Z
B Y
B X
A X
B X
B Z
C Y
B Y
C Y
C X
B X
C Y
C Y
A Y
C Y
B X
B X
A Z
B X
B Z
C X
A Z
C Z
C Y
A Z
A Z
B Z
C X
A Z
C Y
A Z
A Z
B X
B Y
B Z
C X
C Y
B X
A Z
B X
A Z
B X
A Z
B X
A X
C Y
B Y
C Y
B X
A Z
B X
C Y
B Y
B Y
B X
A Z
B X
C Y
A X
A Y
B X
A Z
A Z
B Y
A Z
A Z
C Y
B Y
A Z
C Y
C Y
C Y
B Y
A Z
B X
A Z
C Z
A Z
A Y
B Z
C Y
A Z
C Y
C X
B Y
A Z
A Z
B X
A X
A Z
B X
A Z
C Y
C X
A Z
A Z
C X
A X
A Z
C Y
A Z
A Z
C X
C Y
B X
B Y
B Y
C Y
C Z
B Z
C X
C Y
A X
A Z
B X
B Y
B Y
C X
B Z
B Y
B X
B Y
C X
C Y
B X
B Y
B X
C X
C Y
C X
A Z
B Z
B Z
C X
C X
B X
C X
B X
C Y
C Y
C Y
B X
C Y
C X
A X
A Z
A X
A Z
B X
B X
A Z
A X
B Y
A Z
B X
A Y
B X
C Y
A Y
A Y
B X
B Y
C Z
C Y
B Y
B Y
B X
A Z
A Z
B X
A X
B X
B Y
B X
B X
A Z
C X
A Z
A X
A Z
B Z
B X
A Z
C X
A X
B Y
C X
B X
C X
A Y
A Z
B Y
C Y
A Z
A Z
A Z
A Z
A X
A Z
B X
A Z
C X
A Z
B Y
C Y
A Z
B X
A Z
C Y
B X
C Z
B Y
C X
A Z
A X
C Y
B Y
B X
C Y
C X
A Z
B X
C Y
A Z
A Y
C Y
B X
C X
B Y
A X
C Y
B X
C Y
A Z
A Z
A Z
C Y
B Z
B X
A Z
A X
B X
C X
B X
A Z
B X
B X
B Y
B X
A Z
C X
B X
A Z
A Z
C X
A X
A X
B X
B Y
A Z
C Y
C Y
B X
B X
A X
A Z
A Z
A X
B X
A Z
B Y
C X
B X
B X
C Y
A Z
B X
A X
C Y
C Y
C Y
A Z
B Y
C Y
C Y
C X
A Z
B Y
B X
B Y
B X
C Y
C Y
A X
B X
B X
C Z
C Y
B Z
A Z
B X
B X
B Y
C Y
C Y
A Z
C X
B X
B X
A Z
B Y
B Z
B X
A Z
A Z
A Z
C X
C Y
C X
C X
A X
C X
C Y
A X
B X
A Z
A X
B Y
B X
A Z
A Z
C Y
B Y
A Z
B X
C X
A Z
A Z
C X
B X
C Y
B X
B X
C Y
A Z
A Z
A Z
A X
A X
B X
A Z
B X
A X
C Y
C X
C X
A X
A Z
C Y
B X
A Z
A Z
A X
A Z
B Y
C X
B X
C X
C X
C X
A X
C Y
A Z
C Y
B X
B X
B X
C Y
C Y
A Z
A Z
C Y
A Z
B Y
B X
A Z
B Y
C Y
A Z
C X
B X
C Y
C Y
C X
C X
A Z
B X
A Z
B X
C X
B X
C Y
C Z
C X
C Y
A Z
A Z
A Z
B Z
B X
A Z
A Z
B X
A X
B Y
B X
C Y
C Y
A Z
B X
C Y
A X
A Z
B Z
A Z
C X
B Y
B Y
A Z
A Z
C Y
B X
C Z
C X
A Z
A Z
B X
B X
A X
B Y
C X
A Z
C Y
A X
B X
A Z
B Y
B X
B Y
A Z
B Y
C X
A Z
B X
A Z
C Z
A Z
A X
B X
C Y
A Z
A Z
A Z
C X
B X
A Z
A Z
B X
A Z
A Z
B Z
A Z
C Y
B X
C Y
C Y
C X
B X
A Z
B Y
A Z
C X
B X
C Y
A Z
B X
B Y
C X
C Y
A X
C Y
B Z
C X
B X
C X
B X
A Z
B X
A Z
B Y
B X
A Z
B Z
A X
B Y
B X
C X
C X
B X
B Y
C Y
B X
C X
C X
C Y
A Z
C X
A Z
C Z
C X
B X
B X
A Z
A X
A Z
C X
A Z
B X
A Z
B Y
A Z
A Z
A Z
B Y
A Z
A X
A Z
C Y
A Z
C Y
A Z
A Z
C Y
A Z
A Z
C Y
B Y
A Z
A Z
A X
C X
B X
A Y
B Y
A Z
C Y
C Y
A Y
C Y
B Y
B X
A Z
B Y
C X
A Z
A Z
A Z
B Z
A Z
C Y
B X
B X
C Y
A Z
C Y
A Z
A X
A Z
B Z
C Y
B X
C Y
A Z
C Y
B X
C Y
B Z
B X
A Z
C Y
A Z
C Z
A Z
C X
B X
A X
A X
B Y
A X
B Z
B X
A Z
B Y
B X
A Z
A Z
A Z
C X
A Z
B Y
C Y
A Z
C X
A Y
A Z
B Z
B Z
C Y
A X
B X
B Y
C Y
C Y
A X
A Z
C X
C Y
C Y
B Y
B X
A Z
B X
A Z
A Z
B X
B Y
B X
A X
C Y
B X
B Z
A Z
A X
C X
B Y
C Z
B X
A X
B Y
A Z
C Y
C Y
A X
C Y
B X
A Z
A Z
A Z
A Y
B X
B X
A Z
C X
A Z
C Z
B Z
A Z
B X
A Z
C Y
B Y
B X
A Z
C Z
B Y
A Y
B X
B Y
A Z
C Y
B X
A Z
B X
C Y
A X
C X
A Z
A X
A X
A X
C Y
C X
A Z
A Z
C Y
B X
B Y
B X
B Y
A Z
C Y
B Y
B X
A Y
B Y
A Z
B X
B X
A Z
C X
B Y
A Z
A X
C X
C X
A Z
C Y
B Y
A Z
A Z
C Y
C X
A Z
C X
B X
C Y
C X
C Y
B X
B Y
C X
A Z
A Z
C Z
A Z
A Z
C X
C X
B X
B X
C X
B Y
A Z
C Y
C X
B Z
B X
B X
C X
B X
A Z
C Y
A X
B Y
B X
C X
B X
C Y
B X
B Y
A Z
C Z
C X
B Y
A Z
B Z
C Y
B Y
A Z
A Z
B X
B X
B Y
A Z
B X
B Z
A Z
C Y
C Y
A Z
B Z
C Y
C Y
C X
B X
B X
C Y
B X
C X
C X
A X
C Y
B Y
A Z
C Y
A X
A Z
A Z
C Y
C Y
B Y
B Y
A X
A Z
B X
A X
A X
B Y
B Y
B X
C X
A Z
A Z
B Y
C Y
C X
B Y
B Y
A X
B X
C Y
B X
A Z
A Z
C Z
A Z
B Z
B Z
B X
A X
C Y
B X
B X
C X
A Z
B X
C X
C Y
C Y
A Z
A Y
C Y
C Y
B X
A Y
B Z
A Z
A Z
C X
C Y
A Z
A Z
B X
B Y
A Z
A Y
B X
C Y
A Z
B Y
B X
B X
B X
A Z
A Z
A X
B Z
B Z
A X
C Y
C Y
B X
A Z
A X
A Z
C X
A Z
C Y
A Z
A Z
B X
A Z
C X
C Y
C X
B Y
C Y
B X
A Z
B Y
A Z
A Z
A Z
C X
C X
B Z
B Z
B X
B Y
A Z
C X
C Y
A X
C Z
A Z
B X
C X
B X
A Z
B X
A Z
C X
A X
B X
B X
A Z
B X
B X
C Z
B Z
B X
A Y
C X
B X
B Y
B Z
C Y
B X
C X
C Y
A X
B X
C X
C X
B X
A Z
C Y
B X
A X
A Z
B X
B X
C X
A X
A X
A X
C Y
A Z
C X
A Z
C X
C X
A Z
C Y
A Z
B Y
A Z
B X
C X
A Z
C X
B Z
B X
A X
C X
C X
C Y
C Y
B X
B Y
B X
C Y
C X
C Y
B Y
A Z
B Z
C Y
C Y
A Z
B X
C Y
A Z
A Z
A X
B X
A Z
B X
A X
C X
B Y
B X
A Z
C X
C X
B X
C Y
C Y
C Y
A Z
B X
A Z
B Y
A X
B X
A Z
B Y
B Y
B X
C X
A X
B Y
A Z
B X
C X
B X
A Z
C Y
A Z
A Z
B X
B X
A X
A X
C Z
C X
B Z
C Y
A Z
C Y
C Y
A Z
B X
C Z
C X
B X
C X
A Z
C Y
C Y
B X
A Z
C X
B X
B X
A X
C Y
B X
A Z
A Z
B X
B X
B Y
A Z
A Z
B Y
B X
C X
B X
A X
A Z
A X
B X
B X
C Y
A Z
A X
C Y
B X
C X
C X
C X
C X
B Z
B Y
C X
A X
C Y
C Y
C X
B X
B Y
B X
B X
B X
C X
B X
B X
C Y
C Z
B X
C Z
A Z
A Z
C Y
B Z
B Y
A Z
A Y
C Y
B X
C Y
A Z
B Y
C Y
C Y
A Z
A Z
C Z
A X
A Y
B Y
A Z
A Z
A X
C Y
B Y
A Z
A Z
B Y
C Y
C Y
A Z
A Z
B Y
A Z
B X
A X
A Z
B Y
C Y
C X
A X
C X
C Y
B X
B X
A Z
C Y
B X
B Y
C Y
A X
B Z
B Y
C Y
C Y
A Z
A Z
A X
C Y
A Z
B X
A Z
C X
C X
C Y
C X
B X
C X
A Z
B X
B X
B Y
B X
C Y
A Z
B Y
B X
C X
C Y
C Y
A Z
A Z
B Z
B X
A Z
C Y
A Z
B X
A Z
A Z
B X
B Y
A Z
B Z
C Y
A X
C Y
C Y
B Y
B Y
B X
C X
A Z
B Z
A X
C Y
B X
A Z
A Z
C Y
B X
C X
B X
A Z
C Y
A Z
B Z
A Z
A Z
A Z
B X
C Y
C Y
C Y
A Y
C X
C Y
B Y
A Z
C Y
A X
A X
C Y
A X
B Y
C X
C Y
A Z
C Y
A X
B Y
C Y
B Y
B X
B X
C Y
A Z
C X
A Z
C Y
A Z
C Z
A Z
C Y
A Z
C X
A X
C Y
B Y
C Y
C X
A Y
A Z
C Z
A Z";

    public Day2(uint day) : base(day)
    {

    }

    public override Solution Solve()
    {
        var rounds = RawInput.Split(Environment.NewLine)
            .Select(r => r.Split(' '))
            .ToArray();

        var part1 = rounds
            .Select(r => (Opponent: GetHand(r[0]), You: GetHand(r[1])))
            .Sum(r => GetPoints(r.Opponent, r.You));

        var part2 = rounds
            .Select(r => (Opponent: GetHand(r[0]), Outcome: GetOutcome(r[1])))
            .Select(r => (r.Opponent, You: GetHandFromOpponentsHand(r.Opponent, r.Outcome)))
            .Sum(r => GetPoints(r.Opponent, r.You));

        return new Solution(Day, part1.ToString(), part2.ToString());
    }

    private static RPS GetHand(string hand)
    {
        return hand switch
        {
            "A" or "X" => RPS.Rock,
            "B" or "Y" => RPS.Paper,
            "C" or "Z" => RPS.Scissors,
            _ => throw new Exception("Wrong input?")
        };
    }

    private static Outcome GetOutcome(string input)
    {
        return input switch
        {
            "X" => Outcome.Lose,
            "Y" => Outcome.Draw,
            "Z" => Outcome.Win,
            _ => throw new Exception("Wrong input?")
        };
    }

    private static int GetPoints(RPS left, RPS right)
    {
        var outcome = (int)right;

        if (left == right)
            return outcome + 3;

        switch (right)
        {
            case RPS.Paper when left is RPS.Scissors:
            case RPS.Rock when left is RPS.Paper:
            case RPS.Scissors when left is RPS.Rock:
                return outcome;
            case RPS.Paper when left is RPS.Rock:
            case RPS.Rock when left is RPS.Scissors:
            case RPS.Scissors when left is RPS.Paper:
                return outcome + 6;
            default:
                return outcome + 3;
        }
    }

    private static RPS GetHandFromOpponentsHand(RPS opponent, Outcome outcome)
    {
        switch (opponent)
        {
            case RPS.Paper when outcome is Outcome.Win:
            case RPS.Rock when outcome is Outcome.Lose:
                return RPS.Scissors;
            case RPS.Paper when outcome is Outcome.Lose:
            case RPS.Scissors when outcome is Outcome.Win:
                return RPS.Rock;
            case RPS.Rock when outcome is Outcome.Win:
            case RPS.Scissors when outcome is Outcome.Lose:
                return RPS.Paper;

            default:
                return opponent;
        }
    }

}